clear

S0 = 100;
K = [90, 100, 110];
r = 0.05;
q = 0;
sigma = 0.2;
t = 1;

gamma = -0.1;
delta = 0.1;

lambda = 5;

% a = [0.5, 0.3, 0.6, 0.35, 0.7, 0.4, 0.8, 0.45];
% b = [4, 8, 4, 8, 4, 8, 4, 8];
a = [0.3, 0.15, 0.4, 0.2, 0.5, 0.25, 0.6, 0.3] * 2;
b = [5, 10, 5, 10, 5, 10, 5, 10] * 0.8;

% a = [0.3, 0.15, 0.4, 0.2, 0.5, 0.25, 0.6, 0.3];
% b = [5, 10, 5, 10, 5, 10, 5, 10];

ab  = a .* b;
v = lambda * (1 - 1 ./ ab);
N = 30;

[PMF, Tail, Price, MVSK] = hwakes(S0, K, r, q, sigma, t, gamma, delta, lambda, v, a, b, N);

